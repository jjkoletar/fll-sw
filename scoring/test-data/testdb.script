CREATE SCHEMA PUBLIC AUTHORIZATION DBA
CREATE MEMORY TABLE TOURNAMENTS(NAME VARCHAR(128) NOT NULL PRIMARY KEY,LOCATION LONGVARCHAR,NEXTTOURNAMENT VARCHAR(128) DEFAULT NULL)
CREATE MEMORY TABLE PLAYOFFDATA(EVENT_DIVISION VARCHAR(32) NOT NULL,TOURNAMENT VARCHAR(128) NOT NULL,PLAYOFFROUND INTEGER NOT NULL,LINENUMBER INTEGER NOT NULL,TEAM INTEGER DEFAULT -3,ASSIGNEDTABLE VARCHAR(64) DEFAULT NULL,PRINTED BOOLEAN DEFAULT FALSE,PRIMARY KEY(EVENT_DIVISION,TOURNAMENT,PLAYOFFROUND,LINENUMBER))
CREATE MEMORY TABLE TEAMS(TEAMNUMBER INTEGER NOT NULL PRIMARY KEY,TEAMNAME VARCHAR(255) DEFAULT '<No Name>' NOT NULL,ORGANIZATION VARCHAR(255),DIVISION VARCHAR(32) DEFAULT '1' NOT NULL,REGION VARCHAR(255) DEFAULT 'DUMMY' NOT NULL)
CREATE MEMORY TABLE TOURNAMENTTEAMS(TEAMNUMBER INTEGER NOT NULL,TOURNAMENT VARCHAR(128) NOT NULL,EVENT_DIVISION VARCHAR(32) DEFAULT '1' NOT NULL,ADVANCED BOOLEAN DEFAULT FALSE NOT NULL,PRIMARY KEY(TEAMNUMBER,TOURNAMENT))
CREATE MEMORY TABLE TOURNAMENTPARAMETERS(PARAM VARCHAR(64) NOT NULL PRIMARY KEY,VALUE LONGVARCHAR NOT NULL,DESCRIPTION VARCHAR(255) DEFAULT NULL)
CREATE MEMORY TABLE JUDGES(ID VARCHAR(64) NOT NULL,CATEGORY VARCHAR(64) NOT NULL,TOURNAMENT VARCHAR(128) NOT NULL,EVENT_DIVISION VARCHAR(32) NOT NULL,PRIMARY KEY(ID,CATEGORY,TOURNAMENT,EVENT_DIVISION))
CREATE MEMORY TABLE TABLENAMES(TOURNAMENT VARCHAR(64) NOT NULL,PAIRID INTEGER NOT NULL,SIDEA VARCHAR(64) NOT NULL,SIDEB VARCHAR(64) NOT NULL,PRIMARY KEY(TOURNAMENT,PAIRID))
CREATE MEMORY TABLE PERFORMANCE(TEAMNUMBER INTEGER NOT NULL,TOURNAMENT VARCHAR(128) NOT NULL,RUNNUMBER INTEGER NOT NULL,TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,NOSHOW BOOLEAN DEFAULT FALSE NOT NULL,BYE BOOLEAN DEFAULT FALSE NOT NULL,PIZZA_OFF_PANT_LEG INTEGER,PIZZA_IN_DIRT_TRAP INTEGER,SMART_MEDICINE INTEGER,SMART_MEDICINE_RETRIEVE INTEGER,ATOMIC_FORCE INTEGER,MOVE_ATOMS_WHITE INTEGER,SELF_ASSEMBLY INTEGER,ATP_BASE INTEGER,ATP_FRAME INTEGER,DUMPER INTEGER,DIRT_TRAP INTEGER,DIRT_IN_TRAP INTEGER,DIRT_ELSEWHERE INTEGER,DIRT_IN_BASE INTEGER,SPACE_ELEVATOR INTEGER,NANOTUBE_STRENGTH LONGVARCHAR,ROBOT_TYPE LONGVARCHAR,COMPUTEDTOTAL INTEGER DEFAULT NULL,STANDARDIZEDSCORE FLOAT DEFAULT NULL,PRIMARY KEY(TEAMNUMBER,TOURNAMENT,RUNNUMBER))
CREATE MEMORY TABLE HEAD2HEAD(TEAMNUMBER INTEGER NOT NULL,TOURNAMENT VARCHAR(128) NOT NULL,JUDGE VARCHAR(64) NOT NULL,NOSHOW BOOLEAN DEFAULT FALSE NOT NULL,SCORE INTEGER,BONUS INTEGER,COMPUTEDTOTAL INTEGER DEFAULT NULL,STANDARDIZEDSCORE FLOAT DEFAULT NULL,PRIMARY KEY(TEAMNUMBER,TOURNAMENT,JUDGE))
CREATE MEMORY TABLE TEAMWORK(TEAMNUMBER INTEGER NOT NULL,TOURNAMENT VARCHAR(128) NOT NULL,JUDGE VARCHAR(64) NOT NULL,NOSHOW BOOLEAN DEFAULT FALSE NOT NULL,DYNAMICS INTEGER,MANAGEMENT INTEGER,STRUCTURE INTEGER,COMMUNICATION INTEGER,GENERAL INTEGER,COMPUTEDTOTAL INTEGER DEFAULT NULL,STANDARDIZEDSCORE FLOAT DEFAULT NULL,PRIMARY KEY(TEAMNUMBER,TOURNAMENT,JUDGE))
CREATE MEMORY TABLE RESEARCH(TEAMNUMBER INTEGER NOT NULL,TOURNAMENT VARCHAR(128) NOT NULL,JUDGE VARCHAR(64) NOT NULL,NOSHOW BOOLEAN DEFAULT FALSE NOT NULL,DEFINITION INTEGER,DESIGN INTEGER,EVALUATION INTEGER,INNOVATION INTEGER,COMMUNICATIONS INTEGER,SUBMITTED LONGVARCHAR,COMPUTEDTOTAL INTEGER DEFAULT NULL,STANDARDIZEDSCORE FLOAT DEFAULT NULL,PRIMARY KEY(TEAMNUMBER,TOURNAMENT,JUDGE))
CREATE MEMORY TABLE FINALSCORES(TEAMNUMBER INTEGER NOT NULL,TOURNAMENT VARCHAR(128) NOT NULL,HEAD2HEAD FLOAT DEFAULT NULL,TEAMWORK FLOAT DEFAULT NULL,RESEARCH FLOAT DEFAULT NULL,PERFORMANCE FLOAT DEFAULT NULL,OVERALLSCORE FLOAT,PRIMARY KEY(TEAMNUMBER,TOURNAMENT))
CREATE VIEW PERFORMANCE_SEEDING_MAX (TEAMNUMBER,TOURNAMENT,SCORE) AS SELECT TeamNumber, Tournament, Max(ComputedTotal) As Score FROM Performance WHERE NoShow = 0 AND RunNumber <= (SELECT Value FROM TournamentParameters WHERE TournamentParameters.Param = 'SeedingRounds') GROUP BY TeamNumber, Tournament
CREATE VIEW CURRENT_TOURNAMENT_TEAMS (TEAMNUMBER,TOURNAMENT,EVENT_DIVISION,ADVANCED) AS SELECT * FROM TournamentTeams WHERE Tournament IN (SELECT Value FROM TournamentParameters WHERE Param = 'CurrentTournament')
CREATE USER SA PASSWORD ""
GRANT DBA TO SA
SET WRITE_DELAY 100 MILLIS
SET SCHEMA PUBLIC
INSERT INTO TOURNAMENTS VALUES('DROP','Dummy tournament for teams that drop out',NULL)
INSERT INTO TOURNAMENTS VALUES('DUMMY','Default dummy tournament',NULL)
INSERT INTO TOURNAMENTPARAMETERS VALUES('ChallengeDocument','<?xml version="1.0" encoding="UTF-8"?>\u000a<fll title="FLL 2006 HSR Challenge: Nano Quest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="fll.xsd">\u000a\u000a  \u000a  \u000a  <Performance minimumScore="0" weight="1.0">\u000a\u000a    <goal initialValue="0" max="2" min="0" multiplier="10" name="pizza_off_pant_leg" title="Pizza Molecule Off Pant Leg"></goal>\u000a    <goal initialValue="0" max="2" min="0" multiplier="50" name="pizza_in_dirt_trap" title="Pizza Molecule In Dirt Trap"></goal>\u000a    <restriction lowerBound="0" message="There cannot be more molecules in the dirt trap than off the pants" upperBound="2">\u000a      <term scoreType="raw" coefficient="1" goal="pizza_off_pant_leg"></term>\u000a      <term scoreType="raw" coefficient="-1" goal="pizza_in_dirt_trap"></term>\u000a    </restriction>\u000a\u000a    <goal initialValue="0" max="1" min="0" multiplier="50" name="smart_medicine" title="Deliver Buckyball"></goal>\u000a\u000a    <goal initialValue="0" max="1" min="0" multiplier="40" name="smart_medicine_retrieve" title="Retrieve Buckyball"></goal>\u000a\u000a    <restriction lowerBound="0" message="One must first retrieve buckyballs before they can be delivered" upperBound="1">\u000a      <term scoreType="raw" coefficient="-1" goal="smart_medicine"></term>\u000a      <term scoreType="raw" coefficient="1" goal="smart_medicine_retrieve"></term>\u000a    </restriction>\u000a    \u000a    <goal initialValue="0" max="1" min="0" multiplier="40" name="atomic_force" title="Free the Probe''s Nanotip"></goal>\u000a\u000a    <goal initialValue="0" max="8" min="0" multiplier="12" name="move_atoms_white" title="Scoring white atoms"></goal>\u000a\u000a    <goal initialValue="0" max="1" min="0" multiplier="25" name="self_assembly" title="Self-alignment of Atoms"></goal>\u000a\u000a    <goal initialValue="0" max="2" min="0" multiplier="25" name="atp_base" title="ATP molecules returned to base"></goal>\u000a\u000a    <goal initialValue="0" max="2" min="0" multiplier="20" name="atp_frame" title="ATP molecules delivered"></goal>\u000a\u000a    <restriction lowerBound="0" message="One must first return the ATP molecules to the base before they can be delivered" upperBound="2">\u000a      <term scoreType="raw" coefficient="1" goal="atp_base"></term>\u000a      <term scoreType="raw" coefficient="-1" goal="atp_frame"></term>\u000a    </restriction>\u000a    \u000a    <goal initialValue="0" max="1" min="0" multiplier="15" name="dumper" title="Robot Emptied Dirt Dumper"></goal>\u000a\u000a    <goal initialValue="0" max="1" min="0" multiplier="15" name="dirt_trap" title="Dirt Trap on Mark"></goal>\u000a    \u000a    <goal initialValue="0" max="8" min="0" multiplier="7" name="dirt_in_trap" title="Dirt in Dirt Trap"></goal>\u000a\u000a    <goal initialValue="0" max="8" min="0" multiplier="3" name="dirt_elsewhere" title="Dirt Elsewhere"></goal>\u000a\u000a    <restriction lowerBound="0" message="There are a maximum of 8 dirt pieces on the table" upperBound="8">\u000a      <term scoreType="raw" coefficient="1" goal="dirt_in_trap"></term>\u000a      <term scoreType="raw" coefficient="1" goal="dirt_elsewhere"></term>\u000a    </restriction>\u000a\u000a    <restriction lowerBound="0" message="There are a maximum of 8 dirt pieces on the table" upperBound="8">\u000a    <term scoreType="raw" coefficient="1" goal="dirt_in_base"></term>\u000a    <term scoreType="raw" coefficient="1" goal="dirt_elsewhere"></term>\u000a  </restriction>\u000a    \u000a    <goal initialValue="0" max="8" min="0" multiplier="5" name="dirt_in_base" title="Dirt in Trap at Base"></goal>\u000a\u000a    <restriction lowerBound="0" message="If the dirt trap is at base, then the dirt in the trap counts for both Dirt in Dirt Trap and Dirt in Trap at Base" upperBound="8">\u000a      <term scoreType="raw" coefficient="1" goal="dirt_in_trap"></term>\u000a      <term scoreType="raw" coefficient="-1" goal="dirt_in_base"></term>\u000a    </restriction>\u000a    \u000a    <goal initialValue="0" max="1" min="0" multiplier="40" name="space_elevator" title="Operate Space Elevator"></goal>\u000a\u000a    <goal initialValue="0" max="1" min="0" multiplier="1" name="nanotube_strength" title="Nanotube Strength">\u000a      <value score="40" title="Supported by Cable" value="supported_by_cable"></value>\u000a      <value score="20" title="Truck on Frame" value="truck_on_frame"></value>\u000a      <value score="0" title="None" value="none"></value>\u000a    </goal>\u000a\u000a    <goal max="1" min="0" multiplier="0" initialValue="1" name="robot_type" title="Robot Type">\u000a      <value score="1" title="RCX" value="rcx"></value>\u000a      <value score="2" title="NXT" value="nxt"></value>\u000a    </goal>\u000a    \u000a    <tiebreaker>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="dirt_in_trap"></term>\u000a        <term scoreType="computed" coefficient="1" goal="dirt_elsewhere"></term>\u000a        <term scoreType="computed" coefficient="1" goal="dirt_in_base"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="pizza_in_dirt_trap"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="pizza_off_pant_leg"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="move_atoms_white"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="smart_medicine"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="atp_frame"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="smart_medicine_retrieve"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="atp_base"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="atomic_force"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="dumper"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="dirt_trap"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="self_assembly"></term>\u000a      </test>\u000a      <test winner="HIGH">\u000a        <term scoreType="computed" coefficient="1" goal="nanotube_strength"></term>\u000a      </test>\u000a    </tiebreaker>\u000a\u000a  </Performance>\u000a\u000a  <subjectiveCategory name="head2head" title="Head to Head" weight="5.5">\u000a    <goal initialValue="0" max="700" min="0" multiplier="1" name="score" title="Score"></goal>\u000a    <goal initialValue="0" max="50" min="0" multiplier="1" name="bonus" title="Bonus"></goal>\u000a  </subjectiveCategory>\u000a  \u000a  <subjectiveCategory name="teamwork" title="Team Management" weight="1.0">\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="dynamics" title="Team Dynamics - Decision Making and Problem Solving"></goal>\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="management" title="Team Management - Time, Task, and Project Management"></goal>\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="structure" title="Team Structure - Roles and Participation"></goal>\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="communication" title="Team Communication - Respect, Team Interaction and Confidence"></goal>\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="general" title="Team Management General"></goal>\u000a  </subjectiveCategory>\u000a\u000a  <subjectiveCategory name="research" title="Research Presentation" weight="2.5">\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="definition" title="Problem Definition"></goal>\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="design" title="Design of Solution"></goal>\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="evaluation" title="Evaluation of Solution"></goal>\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="innovation" title="Innovation"></goal>\u000a    <goal initialValue="0" max="20" min="0" multiplier="1" name="communications" title="Communications"></goal>\u000a    <goal initialValue="0" max="1" min="0" multiplier="1" name="submitted" title="Documents Submitted Prior to Competition">\u000a      <value score="33" title="Yes" value="yes"></value>\u000a      <value score="0" title="No" value="no"></value>\u000a    </goal>\u000a  </subjectiveCategory>\u000a\u000a  \u000a</fll>','The XML document describing the challenge')
INSERT INTO TOURNAMENTPARAMETERS VALUES('CurrentTournament','DUMMY','This is the currently running tournament name - see Tournaments table')
INSERT INTO TOURNAMENTPARAMETERS VALUES('SeedingRounds','3','Number of seeding rounds before elimination round - used to downselect top performance scores in queries')
INSERT INTO TOURNAMENTPARAMETERS VALUES('StandardizedMean','100','Standard mean for computing the standardized scores')
INSERT INTO TOURNAMENTPARAMETERS VALUES('StandardizedSigma','20','Standard deviation for computing the standardized scores')
